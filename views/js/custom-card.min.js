/**
 * 2007-2023 PrestaShop
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
 * versions in the future. If you wish to customize PrestaShop for your
 * needs please refer to http://www.prestashop.com for more information.
 *
 *  @author    PrestaShop SA <contact@prestashop.com>
 *  @copyright 2007-2023 PrestaShop SA
 *  @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 *  International Registered Trademark & Property of PrestaShop SA
 *
 * Don't forget to prefix your containers with your own identifier
 * to avoid any conflicts with others containers.
 */
!function(){var e={},t={site_id:"",public_key:""},n="",o=null,r=null,d=!1,l=!1;function a(){o=new MercadoPago(t.public_key),r=o.cardForm({amount:document.getElementById("amount").value,autoMount:!0,processingMode:"aggregator",iframe:!0,form:{id:"mp_custom_checkout",cardNumber:{id:"id-card-number",placeholder:"0000 0000 0000 0000",style:{"font-size":"1rem","font-family":"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif",color:"#7a7a7a"}},cardholderName:{id:"id-card-holder-name"},cardExpirationDate:{id:"id-card-expiration-date",placeholder:"MM/YYYY",mode:"undefined",style:{"font-size":"1rem","font-family":"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif",color:"#7a7a7a"}},securityCode:{id:"id-security-code",placeholder:"CVV",style:{"font-size":"1rem","font-family":"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif",color:"#7a7a7a"}},installments:{id:"id-installments"},identificationType:{id:"id-docType"},identificationNumber:{id:"id-doc-number"},issuer:{id:"id-issuers-options"}},callbacks:{onFormMounted:function(e){if(e)return console.warn("Form Mounted handling error: ",e);c()},onFormUnmounted:function(e){if(u(),e)return console.warn("Form Unmounted handling error: ",e);l?(a(),l=!1):setTimeout((()=>{a()}),5e3)},onIdentificationTypesReceived:function(e,t){if(e)return console.warn("identificationTypes handling error: ",e)},onPaymentMethodsReceived:function(t,n){if(f(),t)return console.warn("paymentMethods handling error: ",t);var o,r,d=n[0].payment_type_id;o=n[0].thumbnail,(r=document.getElementById("id-card-number")).style.background="url("+o+") 98% 50% no-repeat #fff",r.style.backgroundSize="auto 24px",function(e){document.querySelector("#payment_type_id").value=e}(d),"debit_card"===d?document.getElementById("id-installments").setAttribute("disabled","disabled"):document.getElementById("id-installments").removeAttribute("disabled"),function(t){e={issuer:!1,cardholder_name:!1,cardholder_identification_type:!1,cardholder_identification_number:!1};for(var n=0;n<t.length;n++)"issuer_id"===t[n]&&(e.issuer=!0),"cardholder_name"===t[n]&&(e.cardholder_name=!0),"cardholder_identification_type"===t[n]&&(e.cardholder_identification_type=!0),"cardholder_identification_number"===t[n]&&(e.cardholder_identification_number=!0)}(n[0].additional_info_needed),c()},onIssuersReceived:function(e,t){if(e)return console.warn("issuers handling error: ",e)},onInstallmentsReceived:function(e,n){if(e)return console.warn("installments handling error: ",e);var o,r;o=t.site_id,r=n.payer_costs,"MLA"===o&&(s(),document.querySelector("#id-installments").addEventListener("change",(function(e){!function(e){for(var t=document.querySelector("#id-installments"),n=0;n<e.length;n++)if(e[n].installments===t.value){var o=e[n].labels[0].split("|"),r=o[0].replace("_"," "),d=o[1].replace("_"," ");"CFT 0,00%"===r&&"TEA 0,00%"===d&&(r="",d=""),document.querySelector("#mp-tax-cft-text").innerHTML=r,document.querySelector("#mp-tax-tea-text").innerHTML=d}}(r)})))},onCardTokenReceived:function(e,t){if(e)return m(e),console.warn("Token handling error: ",e);!function(e){if(e)return void m(e);if(d)return;var t=r.getCardFormData();document.querySelector("#card_token_id").value=t.token,document.querySelector("#mp_issuer").value=t.issuerId,document.querySelector("#mp_installments").value=t.installments,document.querySelector("#payment_method_id").value=t.paymentMethodId,d=!0,function(e){if("six"===e){document.getElementById("mp-custom-finish-order").setAttribute("disabled","disabled")}else if("seven"===e){var t=document.querySelector("#payment-confirmation button");t&&t.setAttribute("disabled","disabled")}}(n),document.forms.mp_custom_checkout.submit()}(e)},onValidityChange:function(e,t){e&&"cardNumber"===t&&"invalid_length"!==e[0].code&&function(){document.querySelector("#id-card-number","no-repeat #fff"),document.getElementById("mpIssuer")&&(document.getElementById("mpIssuer").innerHTML=" ");c(),u(),f(),l=!0,r.unmount()}()}}})}function c(){e.cardholder_name?document.getElementById("mp-card-holder-div").style.display="block":document.getElementById("mp-card-holder-div").style.display="none",e.issuer?(document.getElementById("container-issuers").style.display="block",document.getElementById("container-installments").classList.remove("col-md-12"),document.getElementById("container-installments").classList.add("col-md-8")):(document.getElementById("container-issuers").style.display="none",document.getElementById("container-installments").classList.remove("col-md-8"),document.getElementById("container-installments").classList.add("mp-md-12"),document.getElementById("id-issuers-options").innerHTML="",s()),e.cardholder_identification_type?(document.getElementById("mp-doc-div-title").style.display="block",document.getElementById("mp-doc-div").style.display="block",document.getElementById("mp-doc-type-div").style.display="block",o.getIdentificationTypes()):document.getElementById("mp-doc-type-div").style.display="none",e.cardholder_identification_number?(document.getElementById("mp-doc-div-title").style.display="block",document.getElementById("mp-doc-div").style.display="block",document.getElementById("mp-doc-number-div").style.display="block"):document.getElementById("mp-doc-number-div").style.display="none",e.cardholder_identification_type||e.cardholder_identification_number||(document.getElementById("mp-doc-div-title").style.display="none",document.getElementById("mp-doc-div").style.display="none")}function s(){document.querySelector(".mp-text-cft").innerHTML="",document.querySelector(".mp-text-tea").innerHTML=""}function u(){f(),s(),document.getElementById("id-card-number").style.background="no-repeat #fff",document.getElementById("id-card-expiration-date").value="",document.getElementById("id-doc-number").value="",document.getElementById("id-security-code").value="",document.getElementById("id-card-holder-name").value=""}function m(e){var t,n,o,r=g(),d=(t=new Date,n=t.getFullYear(),o=t.getMonth()+1,[{code:"mp001",message:"cardnumber should be a number."},{code:"mp002",message:"cardNumber should be of length between '8' and '19'."},{code:"mp003",message:"expirationMonth should be a number."},{code:"mp004",message:"expirationYear should be of length '2' or '4'."},{code:"mp005",message:"expirationYear should be a number."},{code:"mp006",message:"securityCode should be a number."},{code:"mp007",message:"securityCode should be of length '3' or '4'."},{code:"mp008",message:"expirationMonth should be a value from 1 to 12."},{code:"mp009",message:`expirationYear value should be greater or equal than ${n}.`},{code:"mp010",message:"securityCode should be of length '4'."},{code:"mp011",message:"cardNumber should be of length '15'."},{code:"mp012",message:`expirationMonth value should be greater than '${o}' or expiration\n                  year value should be greater than '${n}.`},{code:"mp013",message:"securityCode should be of length '3'."},{code:"mp014",message:"cardNumber should be of length '16'."}]);let i=e.message||e[0].message,l=e.field||(e[0].field?e[0].field:void 0);var a;i&&!l&&otherMessages(e),e.length>=1&&(!function(e){e.forEach((e=>{let t;"cardNumber"===e.field&&(t=document.getElementById("id-card-number"),t.classList.add("mp-form-control-error")),"expirationDate"===e.field&&(t=document.getElementById("id-card-expiration-date"),t.classList.add("mp-form-control-error")),"securityCode"===e.field&&(t=document.getElementById("id-security-code"),t.classList.add("mp-form-control-error"))}))}(e),e.forEach((e=>{if(e.field&&a!==e.field){l=e.field,"expirationDate"===e.field&&(l=function(e){return expiration=e.message.includes("expirationMonth")?e.field+"_expirationMonth":e.field+"_expirationYear",expiration}(e));let n=`${e.cause}_${l}`;var t;d.forEach((o=>{e.message===o.message&&void 0!==(t=r.querySelector("#"+n+"_"+o.code))&&(t.style.display="block"),a=e.field}))}}))),y(),p()}function y(){void 0!==document.querySelectorAll(".mp-form-control-error")&&document.querySelectorAll(".mp-form-control-error")[0].focus()}function f(){for(var e=0;e<document.querySelectorAll("[data-checkout]").length;e++){document.querySelectorAll("[data-checkout]")[e].classList.remove("mp-form-control-error")}for(var t=0;t<document.querySelectorAll(".mp-erro-form").length;t++){document.querySelectorAll(".mp-erro-form")[t].style.display="none"}}function p(){var e=document.getElementById("conditions_to_approve[terms-and-conditions]");if("object"==typeof e&&null!==e)return e.checked=!1,e.checked}function g(){return document.querySelector("#mp_custom_checkout")}function b(){f();var t=function(){for(var e=!1,t=g(),n=t.querySelectorAll("[data-checkout]"),o=["cardNumber","installments"],r=document.getElementById("id-installments").value,d=0;d<n.length;d++){var i=n[d],l=i.getAttribute("data-checkout");if(o.indexOf(l)>-1&&(-1===i.value||""===i.value||void 0===i.value)){var a=t.querySelectorAll('small[data-main="#'+i.id+'"]');("cardNumber"===l&&""===r||void 0===r||"cardNumber"!==l)&&(a[0].style.display="block",i.classList.add("mp-form-control-error"),e=!0)}}return e}(),n=function(){var t=!1;if(e.issuer){var n=document.getElementById("id-issuers-options");-1!==n.value&&""!==n.value||(n.classList.add("mp-form-control-error"),t=!0)}if(e.cardholder_name){var o=document.getElementById("id-card-holder-name");if(-1===o.value||""===o.value||!/^[a-zA-ZãÃáÁàÀâÂäÄẽẼéÉèÈêÊëËĩĨíÍìÌîÎïÏõÕóÓòÒôÔöÖũŨúÚùÙûÛüÜçÇ’ñÑ .']+$/.test(o.value)){document.getElementById(o.id).style.display="block";var r=document.querySelectorAll('small[data-main="#'+o.id+'"]');for(let e=0;e<r.length;e++)r[e].style.display="block";o.classList.add("mp-form-control-error"),t=!0}}if(e.cardholder_identification_type){let e=document.getElementById("id-docType");-1!==e.value&&""!==e.value||(e.classList.add("mp-form-control-error"),t=!0)}if(e.cardholder_identification_number){let e=document.getElementById("id-docType");var d=document.getElementById("id-doc-number");-1===d.value||""===d.value?(d.classList.add("mp-form-control-error"),d.style.display="inline-block",document.querySelector('small[data-main="#'+d.id+'"]').style.display="block",t=!0):"cpf"===e.value.toLowerCase()&&(function(e){if(11===e.length)return function(e){var t,n;if(t=0,"00000000000"==e)return!1;if("11111111111"==e)return!1;if("22222222222"==e)return!1;if("33333333333"==e)return!1;if("44444444444"==e)return!1;if("55555555555"==e)return!1;if("66666666666"==e)return!1;if("77777777777"==e)return!1;if("88888888888"==e)return!1;if("99999999999"==e)return!1;for(i=1;i<=9;i++)t+=parseInt(e.substring(i-1,i))*(11-i);10!=(n=10*t%11)&&11!=n||(n=0);if(n!=parseInt(e.substring(9,10)))return!1;for(t=0,i=1;i<=10;i++)t+=parseInt(e.substring(i-1,i))*(12-i);10!=(n=10*t%11)&&11!=n||(n=0);if(n!=parseInt(e.substring(10,11)))return document.getElementById("mpDocNumber"),!1;return!0}(e);return!1}(d.value)||(d.classList.add("mp-form-control-error"),d.style.display="inline-block",document.querySelector('small[data-main="#'+d.id+'"]').style.display="block"))}return t}();return!t&&!n||(y(),!1)}window.initializeCustom=function(e){t.site_id=e.site_id,t.public_key=e.public_key,n=e.ps_version,a(),document.getElementById("id-installments").addEventListener("keyup",(function(e){e.target.value.length<=1&&u()}))},jQuery((function(){void 0!==document.forms.mp_custom_checkout&&(document.forms.mp_custom_checkout.onsubmit=function(){return b()?(r.createCardToken(),!1):(p(),!1)})}))}();